
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Installation process &#8212; OnTask 1.1.0 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using the tool" href="../Using/index.html" />
    <link rel="prev" title="What is OnTask" href="../Introduction/index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="installation-process">
<span id="install"></span><h1>Installation process<a class="headerlink" href="#installation-process" title="Permalink to this headline">¶</a></h1>
<p>OnTask is a Web application that manages data about learners to provide them
with personalised support. For this reason, it is recommended an installation
that observes a set of tight security restrictions. Some of these
restrictions lie within the scope of the tool, but some other are part of the
environment in which the application is installed. We strongly recommend to
install OnTask in a web server that uses TTL encryption (HTTPS) to serve all
the pages. The application requires exchanging with your browser sensitive
information about your session, so the information should be encrypted.</p>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>OnTask has been developed as a <a class="reference external" href="https://www.djangoproject.com/">Django</a>
application. Django is a high-level, python-based web framework that supports
a rich set of functionalities typically required in applications like OnTask.
But as with many other applications, OnTask requires a set of additional
applications for its execution:</p>
<ul class="simple">
<li>Python 2.7</li>
<li>Django (version 1.11)</li>
<li>Additional Django modules (included in the requirements/base.txt) file</li>
<li>Redis (version 4.0 or later)</li>
<li>PostgreSQL (version 9.5 or later)</li>
</ul>
<p>Some of these requirements are (hopefully) properly handled by
Python through its package index application <a class="reference external" href="https://pypi.python.org/pypi/pip">pip</a>.</p>
</div>
<div class="section" id="installing-the-required-tools">
<h2>Installing the required tools<a class="headerlink" href="#installing-the-required-tools" title="Permalink to this headline">¶</a></h2>
<p>The following installation steps assume that you are deploying OnTask in a
production web server capable of serving pages using the HTTPS protocol.</p>
<div class="section" id="install-and-configure-redis">
<h3>Install and Configure Redis<a class="headerlink" href="#install-and-configure-redis" title="Permalink to this headline">¶</a></h3>
<p>Django requires Redis to execute as a daemon in the same machine to cache
information about the sessions. You do not need to make any adjustments in
the code for this tool, simply have the server running in the background.</p>
<ol class="arabic">
<li><p class="first">Download and install <a class="reference external" href="https://redis.io/">redis</a>.</p>
<p>Follow the instructions to configure it to be used by Django.</p>
</li>
<li><p class="first">Test that it is executing properly in the background (use the <code class="docutils literal"><span class="pre">ping</span></code>
command in the command line interface.</p>
</li>
</ol>
<p>For OnTask you only need executing in the machine. If you use the default
settings, there are not additional changes required in OnTask (the code is
already using this application internally).</p>
</div>
<div class="section" id="install-and-configure-postgresql">
<h3>Install and Configure PostgreSQL<a class="headerlink" href="#install-and-configure-postgresql" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Download and install <a class="reference external" href="https://www.postgresql.org/">postgresql</a>.</p>
</li>
<li><p class="first">Create the role <code class="docutils literal"><span class="pre">ontask</span></code> with the command <code class="docutils literal"><span class="pre">createuser</span></code>. The role
should be able to create new databases but not new roles and you should
define a password for the user (use <code class="docutils literal"><span class="pre">createuser</span> <span class="pre">--interactive</span> <span class="pre">-W</span></code>).</p>
</li>
<li><p class="first">Adjust the access configuration in postgresql (usually in file
<code class="docutils literal"><span class="pre">pg_hba.conf</span></code>) to allow the newly created user to access databases locally.</p>
</li>
<li><p class="first">Create a new database with name <code class="docutils literal"><span class="pre">ontask</span></code> with the <code class="docutils literal"><span class="pre">createdb</span></code> command.</p>
</li>
<li><p class="first">Use the client application <code class="docutils literal"><span class="pre">psql</span></code> to verify that the user has access to
the newly created database and can create and delete a new table and run
regular queries. Try to connect to the database with the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">psql</span> <span class="o">-</span><span class="n">h</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span> <span class="o">-</span><span class="n">U</span> <span class="n">ontask</span> <span class="o">-</span><span class="n">W</span> <span class="n">ontask</span>
</pre></div>
</div>
<p>If the client does not connect to the database, review your configuration
options.</p>
</li>
</ol>
</div>
<div class="section" id="install-python">
<h3>Install Python<a class="headerlink" href="#install-python" title="Permalink to this headline">¶</a></h3>
<p>In the following sections we assume that you can open a command line
interpreter and you can execute the python interpreter.</p>
<ol class="arabic simple">
<li>Install <a class="reference external" href="https://www.python.org/">python</a></li>
<li>Verify that the python interpreter can run and has the right version (2.7)
using the command line interpreter.</li>
<li>Install <a class="reference external" href="https://pip.pypa.io/en/stable/">pip</a> (the package may be called
<code class="docutils literal"><span class="pre">python-pip</span></code>). This tool will be used by both Python and Django to install
numerous libraries that are required to execute OnTask.</li>
</ol>
</div>
<div class="section" id="download-install-and-configure-ontask">
<h3>Download, install and configure OnTask<a class="headerlink" href="#download-install-and-configure-ontask" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Download or clone_actions a copy of <a class="reference external" href="https://github.com/abelardopardo/ontask_b">OnTask</a>.</p>
</li>
<li><p class="first">Using a command interpreter, go to the OnTask folder and locate a folder
inside it with name <code class="docutils literal"><span class="pre">requirements</span></code>. Verify that the <code class="docutils literal"><span class="pre">requirements</span></code>
folder contains the files <code class="docutils literal"><span class="pre">base.txt</span></code>, <code class="docutils literal"><span class="pre">production.txt</span></code> and
<code class="docutils literal"><span class="pre">development.txt</span></code>. The first file contains a list of python modules that
are required by OnTask. The second is a set of additional modules to run a
<em>production</em> instance, and the third is a list if you intend to run a
<em>development</em> instance.</p>
</li>
<li><p class="first">If you plan to run a production instance of OnTask execute the command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">/</span><span class="n">production</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Alternatively, if you plan to run a development instance of OnTask then
execute the command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">/</span><span class="n">development</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>This command traverses a list of libraries and modules and installs them as
part of the python libraries in the system. These modules include Django,
Django Rest Framework, Django braces, etc.</p>
</li>
</ol>
<p>At this point you have the major modules in place. The next steps include the
configuration of the Django environment to run OnTask.</p>
<p>If you plan to install a production instance of OnTask, using a plain text
editor (nano, vim, Emacs or similar) in a command line interpreter, open the
file <code class="docutils literal"><span class="pre">manage.py</span></code> in the <code class="docutils literal"><span class="pre">src</span></code> folder of the project. Modify line 14
replacing the value <code class="docutils literal"><span class="pre">&quot;ontask.settings.development&quot;</span></code> by
<code class="docutils literal"><span class="pre">&quot;ontask.settings.production&quot;</span></code>. Save and close the file.</p>
<p>Using the same plain text editor create a file with name <code class="docutils literal"><span class="pre">local.env</span></code>
in the folder <code class="docutils literal"><span class="pre">src/ontask/settings</span></code> with the following content (note there is
no space between variable names and the equal sign):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">TIME_ZONE</span><span class="o">=</span><span class="s1">&#39;[YOUR LOCAL PYTHON TIME ZONE]&#39;</span>
<span class="c1"># syntax: DATABASE_URL=postgres://username:password@127.0.0.1:5432/database</span>
<span class="n">DATABASE_URL</span><span class="o">=</span><span class="n">postgres</span><span class="p">:</span><span class="o">//</span><span class="p">[</span><span class="n">PSQLUSERNAME</span><span class="p">]:[</span><span class="n">PSQLPWD</span><span class="p">]</span><span class="nd">@127</span><span class="o">.</span><span class="mf">0.0</span><span class="o">.</span><span class="mi">1</span><span class="p">:</span><span class="mi">5432</span><span class="o">/</span><span class="n">ontask</span>
<span class="n">SECRET_KEY</span><span class="o">=</span>
<span class="n">LTI_OAUTH_CREDENTIALS</span><span class="o">=</span><span class="n">key1</span><span class="o">=</span><span class="n">secret1</span><span class="p">,</span><span class="n">key2</span><span class="o">=</span><span class="n">secret2</span>
</pre></div>
</div>
<ol class="arabic">
<li><p class="first">Open a command interpreter and execute the following python command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import tzlocal; print(tzlocal.get_localzone().zone)&#39;</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal"><span class="pre">[YOUR</span> <span class="pre">LOCAL</span> <span class="pre">PYTHON</span> <span class="pre">TIME</span> <span class="pre">ZONE]</span></code> in the <code class="docutils literal"><span class="pre">local.env</span></code> file by the
description of your time zone produced by the previous command.</p>
</li>
<li><p class="first">Modify the line starting with <code class="docutils literal"><span class="pre">DATABASE_URL=</span></code> and change the
field <code class="docutils literal"><span class="pre">[PSQLUSERNAME]</span></code> with the name of the Postgresql user created in the
previous step (the one that could access the ontask database and run
queries). If you decided to use a different name for the database, adjust
the last part of the line accordingly (replace <em>ontask</em> by the name of
your database).</p>
</li>
<li><p class="first">Open a command interpreter and execute the following python command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import random; import string; print(&quot;&quot;.join([random.SystemRandom().choice(string.digits + string.ascii_letters + string.punctuation) for i in range(100)]))&#39;</span>
</pre></div>
</div>
<p>Copy the long string produced as output and add it at the end of the last
line of the file <code class="docutils literal"><span class="pre">local.env</span></code>. It should look something like (with
different content after the equal sign):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">SECRET_KEY</span><span class="o">=</span><span class="mi">4</span><span class="n">o93jf0572094jv</span><span class="o">...</span>
</pre></div>
</div>
</li>
<li><p class="first">Modify the line starting with <code class="docutils literal"><span class="pre">LTI_OAUTH_CREDENTIALS</span></code> and include a
comma-separated list of pairs key=secret for LTI authentication. See the
section  <a class="reference internal" href="#authentication"><span class="std std-ref">Authentication</span></a> for more details about this type of
authentication.</p>
</li>
<li><p class="first">Create a new folder with name <code class="docutils literal"><span class="pre">logs</span></code> in the OnTask top folder (next to
the <code class="docutils literal"><span class="pre">requirements</span></code> folder). This folder <strong>is different</strong> from the folder
with the same name in the <code class="docutils literal"><span class="pre">src</span></code> folder.</p>
</li>
<li><p class="first">If at some point during the following steps you want to reset
the content of the database, run the commands <code class="docutils literal"><span class="pre">dropdb</span></code> and <code class="docutils literal"><span class="pre">createdb</span></code></p>
</li>
<li><p class="first">Execute the following commands from the <code class="docutils literal"><span class="pre">src</span></code> folder to prepare the
database initialization:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">makemigrations</span> <span class="n">profiles</span> <span class="n">accounts</span> <span class="n">workflow</span> <span class="n">dataops</span>
<span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">makemigrations</span> <span class="n">table</span> <span class="n">action</span> <span class="n">logs</span> <span class="n">scheduler</span> <span class="n">table</span>
</pre></div>
</div>
</li>
<li><p class="first">Execute the following command to create the database internal structure:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">migrate</span>
</pre></div>
</div>
<p>A few messages should appear on the screen related to the initialization
of the database.</p>
</li>
<li><p class="first">Execute the following command to upload to the platform some initial data
structures:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">runscript</span> <span class="o">-</span><span class="n">v1</span> <span class="o">--</span><span class="n">traceback</span> <span class="n">initial_data</span>
</pre></div>
</div>
<p>The command should run without any error or exception.</p>
</li>
<li><p class="first">Execute the command to create a superuser
account in OnTask:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">createsuperuser</span>
</pre></div>
</div>
<p>Remember the data that you enter in this step so that
you use it when you enter OnTask with your browser.</p>
</li>
<li><p class="first">Go to the <code class="docutils literal"><span class="pre">docs</span></code> folder to generate the documentation. Make sure this
folder contains the sub-folders with name <code class="docutils literal"><span class="pre">_static</span></code> and <code class="docutils literal"><span class="pre">_templates</span></code>.
Execute the command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">html</span>
</pre></div>
</div>
<p>The documentation is produced by the <code class="docutils literal"><span class="pre">sphinx-doc</span></code> application and
generates the directory <code class="docutils literal"><span class="pre">_build</span></code>. The documentation for the platform is in
the folder <code class="docutils literal"><span class="pre">_build/html</span></code>.</p>
</li>
<li><p class="first">Copy the entire <code class="docutils literal"><span class="pre">html</span></code> folder (inside <code class="docutils literal"><span class="pre">_build</span></code>) over to the
<code class="docutils literal"><span class="pre">src/static</span></code> folder (in Unix <code class="docutils literal"><span class="pre">cp</span> <span class="pre">-r</span> <span class="pre">_build/html</span> <span class="pre">../src/static</span></code>).</p>
</li>
<li><p class="first">From the <code class="docutils literal"><span class="pre">src</span></code> folder execute the following command to collect and install
the static content:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">collectstatic</span>
</pre></div>
</div>
</li>
<li><p class="first">If you are running a production instance, execute the following
command to check the status of the platform:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">check</span> <span class="o">--</span><span class="n">deploy</span>
</pre></div>
</div>
<p>The command should print just one warning about the configuration variable
X_FRAME_OPTIONS. If you are running a development instance, you will get
various additional warning that are derived most of them from running the
instance without HTTPS.</p>
</li>
<li><p class="first">Execute the following command to start the OnTask server:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">runserver</span>
</pre></div>
</div>
<p>If there are no errors, the message on the screen should say that your
server is running and available in the URL 127.0.0.1:8000</p>
</li>
<li><p class="first">If OnTask is going to be accessed through a web server like Apache or Nginx,
stop the application and configure the web server accordingly.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="the-administration-pages">
<h2>The Administration Pages<a class="headerlink" href="#the-administration-pages" title="Permalink to this headline">¶</a></h2>
<p>As many applications developed using Django, OnTask takes full advantage of
the administration pages offered by the framework. The account created with
the command <code class="docutils literal"><span class="pre">createsuperuser</span></code> has complete access to those pages through a
link in the upper right corner of the screen.</p>
<p>These pages offer access to several important operations:</p>
<ul class="simple">
<li>The elements of each of the models stored in the database (workflows,
actions, conditions, columns, etc). Each model has its corresponding page
allowing the creation, update and deletion of any object.</li>
<li>The user information. This is a special model representing the users, their
name, credentials, etc. The platform allows the creation of user accounts.</li>
<li>The group information. The platform differentiates users based on groups.
Each group has different functionalities.</li>
</ul>
<p>Once the instance is running, visit these pages and configure the platform to
your needs.</p>
</div>
<div class="section" id="production-deployment">
<h2>Production Deployment<a class="headerlink" href="#production-deployment" title="Permalink to this headline">¶</a></h2>
<p>Once OnTask is executing normally, you may configure a web server (nginx,
apache or similar) to make it available to a community of users. The
instructions to make such deployment are beyond the scope of this manual but
they are available for users to consult.</p>
</div>
<div class="section" id="authentication">
<span id="id1"></span><h2>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h2>
<p>OnTask comes with the following authentication mechanisms: IMS-LTI,
<code class="docutils literal"><span class="pre">REMOTE_USER</span></code> variable, basic authentication, and LDAP. The first three
(IMS-LTI, <code class="docutils literal"><span class="pre">REMOTE_USER</span></code> and basic authentication) are enabled by default and used in that order whenever an unauthenticated request is received. It follows a brief description of how to configure them.</p>
<ul>
<li><p class="first"><a class="reference external" href="http://www.imsglobal.org/activity/learning-tools-interoperability">IMS Learning Tools Interoperability (IMS-LTI)</a>. LTI
is a standard developed by the IMS Global Learning Consortium to integrate
multiple tools within a learning environment. In LTI terms, OnTask is
configured to behave as a <em>tool provider</em> and assumes a <em>tool consumer</em> such
as a Learning Management System to invoke its functionality. Any URL in
OnTask can be give nto the LTI consumer as the point of access.</p>
<p>Ontask only provides two points of access for LTI requests coming from the
consumer. One is the URL with suffix <code class="docutils literal"><span class="pre">/lti_entry</span></code> and the second is the
URL provided by the actions to serve the personalised content (accessible
through the <code class="docutils literal"><span class="pre">Actions</span></code> menu.</p>
<p>To allow LTI access you need:</p>
<ol class="arabic">
<li><p class="first">A tool consumer that can be configured to connect with OnTask. This type
of configuration is beyond the scope of this manual.</p>
</li>
<li><p class="first">A set of pairs key,value in OnTask to be given to the tool consumers so
that together with the URL, they are ready to send the requests. The
key/value pairs are specified in the file <code class="docutils literal"><span class="pre">local.env</span></code> in the folder
<code class="docutils literal"><span class="pre">src/ontask/settings</span></code> together with other local configuration variables.
For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">LTI_OAUTH_CREDENTIALS</span><span class="o">=</span><span class="n">key1</span><span class="o">=</span><span class="n">secret1</span><span class="p">,</span><span class="n">key2</span><span class="o">=</span><span class="n">secret2</span>
</pre></div>
</div>
<p>If you change the values of this variable, you need to restart the server
so that the new credentials are in effect.</p>
</li>
</ol>
<p>This authentication has only basic functionality and it is assumed to be
used only for learners (not for instructors).</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">REMOTE_USER</span></code>. The second method uses <a class="reference external" href="https://docs.djangoproject.com/en/1.11/howto/auth-remote-user/#authentication-using-remote-user">the variable REMOTE_USER</a>
that is assumed to be defined by an external application. This method is
ideal for environments in which users are already authenticated and are
redirected to the OnTask pages (for example, using SAML). If OnTask receives
a request from a non-existent user through this channel, it automatically and
transparently creates a new user in the platform with the user name stored in
the <code class="docutils literal"><span class="pre">REMOTE_USER</span></code> variable. OnTask relies on emails as the user name
differentiator, so if you plan to use this authentication method make sure
the value of <code class="docutils literal"><span class="pre">REMOTE_USER</span></code> is the email.</p>
</li>
<li><p class="first">Basic authentication. If the variable <code class="docutils literal"><span class="pre">REMOTE_USER</span></code> is not set in the
internal environment of Django where the web requests are served, OnTask
resorts to conventional authentication requiring email and password. These
credentials are stored in the internal database managed by OnTask.</p>
</li>
</ul>
<div class="section" id="ldap-authentication">
<h3>LDAP Authentication<a class="headerlink" href="#ldap-authentication" title="Permalink to this headline">¶</a></h3>
<p>OnTask may also be configured to use LDAP to authenticate users. This is done
through the external package <a class="reference external" href="https://bitbucket.org/illocution/django-auth-ldap">django-auth-ldap</a>. In its current version,
this authentication mode cannot be combined with the previous ones (this
requires some non-trivial code changes). The following instructions describe
the basic configuration to enable LDAP authentication. For more details check
the <a class="reference external" href="https://django-auth-ldap.readthedocs.io/en/latest/">documentation of the django-auth-ldap module</a>.</p>
<ul>
<li><p class="first">Stop OnTask (if it is running)</p>
</li>
<li><p class="first">Make sure your server has installed the development files for OpenLDAP. In
Debian/Ubuntu, the required packages are:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">libsasl2</span><span class="o">-</span><span class="n">dev</span> <span class="n">python</span><span class="o">-</span><span class="n">dev</span> <span class="n">libldap2</span><span class="o">-</span><span class="n">dev</span> <span class="n">libssl</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>In RedHat/CentOS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span><span class="o">-</span><span class="n">devel</span> <span class="n">openldap</span><span class="o">-</span><span class="n">devel</span>
</pre></div>
</div>
</li>
<li><p class="first">Install the module <code class="docutils literal"><span class="pre">django-auth-ldap</span></code></p>
</li>
<li><p class="first">Edit the configuration file <code class="docutils literal"><span class="pre">local.env</span></code> and define the following two
variables:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">AUTH_LDAP_SERVER_URI</span><span class="o">=</span><span class="p">[</span><span class="n">uri</span> <span class="n">pointing</span> <span class="n">to</span> <span class="n">your</span> <span class="n">ldap</span> <span class="n">server</span><span class="p">]</span>
<span class="n">AUTH_LDAP_PASSWORD</span><span class="o">=</span><span class="p">[</span><span class="n">Password</span> <span class="n">to</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">the</span> <span class="n">server</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p class="first">Edit the  file <code class="docutils literal"><span class="pre">src/ontask/settings/base.py</span></code> and uncomment the lines that
import the <code class="docutils literal"><span class="pre">ldap</span></code> library (<code class="docutils literal"><span class="pre">import</span> <span class="pre">ldap</span></code>) and the lines that import three
methods from the <code class="docutils literal"><span class="pre">django_auth_ldap.config</span></code> module (<code class="docutils literal"><span class="pre">LDAPSearch</span></code>,
<code class="docutils literal"><span class="pre">GroupOfNamesType</span></code> and <code class="docutils literal"><span class="pre">LDAPGroupQuery</span></code>)</p>
</li>
<li><p class="first">Locate the section in the file <code class="docutils literal"><span class="pre">src/ontask/settings/base.py</span></code> that contains
the variables to configure <em>LDAP AUTHENTICATION</em>.</p>
</li>
<li><p class="first">Uncomment the ones needed for your configuration. Make sure all the
information is included to connect to the server, perform the binding, search, and if needed, assign fields to user and group attributes.</p>
</li>
<li><p class="first">Locate the variable <code class="docutils literal"><span class="pre">AUTHENTICATION_BACKENDS</span></code> in the same file.</p>
</li>
<li><p class="first">Comment the lines referring to the back-ends <code class="docutils literal"><span class="pre">LTIAuthBackend</span></code> and
<code class="docutils literal"><span class="pre">RemoteUserBackend</span></code>.</p>
</li>
<li><p class="first">Uncomment the line referring to <code class="docutils literal"><span class="pre">LDAPBackend</span></code>.</p>
</li>
<li><p class="first">Make sure the LDAP server contains the data about the users in the right
format</p>
</li>
<li><p class="first">Start the OnTask server.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="email-configuration">
<span id="email-config"></span><h2>Email Configuration<a class="headerlink" href="#email-configuration" title="Permalink to this headline">¶</a></h2>
<p>OnTask relies on the functionality included in Django to send emails from the
application. The configuration parameters are defined in the file <code class="docutils literal"><span class="pre">base.py</span></code>
and are: <code class="docutils literal"><span class="pre">EMAIL_HOST</span></code>, <code class="docutils literal"><span class="pre">EMAIL_PORT</span></code>, <code class="docutils literal"><span class="pre">EMAIL_HOST_USER</span></code>,
<code class="docutils literal"><span class="pre">EMAIL_HOST_PASSWORD</span></code>, <code class="docutils literal"><span class="pre">EMAIL_USE_TLS</span></code> and <code class="docutils literal"><span class="pre">EMAIL_USE_SSL</span></code>.</p>
<p>Set theses variables in the configuration file to the appropriate values
before starting the application.</p>
</div>
<div class="section" id="scheduling-tasks">
<span id="id2"></span><h2>Scheduling tasks<a class="headerlink" href="#scheduling-tasks" title="Permalink to this headline">¶</a></h2>
<p>OnTask allows to program certain tasks to execute at some point in the
future. This functionality is implemented using a combination of persistent
storage (the database), and a time-based job scheduler external to the tool.
Time-based job schedulers are present in most operating systems (<code class="docutils literal"><span class="pre">cron</span></code>
in Unix/Linux, or <code class="docutils literal"><span class="pre">at</span></code> in Windows). OnTask provides the functionality to
describe the task to execute and assign it a date and time. Additionally, the
tool has a script that checks the date/time, selects the appropriate task,
and executes it. These instructions describe the configuration assuming an
underlying Linux/Unix architecture using <code class="docutils literal"><span class="pre">crontab</span></code>.</p>
<p>Create a <em>crontab</em> file for the user running the server in your production
environment with the following content:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>MAILTO=&quot;[ADMIN EMAIL ADDRESS]&quot;
PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin
SHELL=/bin/bash
ONTASK_PROJECT=[PATH TO ONTASK PROJECT ROOT]

0,15,30,45 * * * * python ${ONTASK_PROJECT}/src/manage.py runscript scheduler_script -v3 --traceback --script-args=&quot;-d&quot; &gt; [CRONTAB LOG] 2&gt;&amp;1
</pre></div>
</div>
<p>Modify the previous script with the following information:</p>
<ul class="simple">
<li>In the first line change the email address by an address to receive the
notifications produced by <code class="docutils literal"><span class="pre">crontab</span></code>. The server running the application
needs to have the capacity to send emails.</li>
<li>Make sure the variable <code class="docutils literal"><span class="pre">PATH</span></code> contains the path to execute <code class="docutils literal"><span class="pre">python</span></code>.</li>
<li>Define the variable <code class="docutils literal"><span class="pre">SHELL</span></code> to point to the shell to use to execute
<code class="docutils literal"><span class="pre">python</span></code>.</li>
<li>Change the value of the variable <code class="docutils literal"><span class="pre">ONTASK_PROJECT</span></code> to point to the root
of OnTask (the folder containing the source code).</li>
<li>In the last line replace <code class="docutils literal"><span class="pre">[CRONTAB</span> <span class="pre">LOG]</span></code> with a file to capture the
output that the screen would write to a regular terminal. We recommend
this file to be in a temporary directory.</li>
</ul>
<p>The script <code class="docutils literal"><span class="pre">scheduler_scrip</span></code> has been configured to print messages through
a logger that writes the messages to the file <code class="docutils literal"><span class="pre">script.log</span></code> in the <code class="docutils literal"><span class="pre">logs</span></code>
folder.</p>
<p>The remaining parameter to adjust is the frequency in which the script
<code class="docutils literal"><span class="pre">scheduler_script</span></code> runs. In the example above, the script executes every 15
minutes (at minutes 0, 15, 30 and 45 minutes in the hour). Adjust this
frequency to suit your needs. Once adjusted, go to the administration menu in
OnTask, open the section with name <em>Core Configuration</em>, click in the
preferences and adjust the value of the <em>Minute interval to program scheduled
tasks</em> and match it (in minutes) to the interval reflected in the crontab.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">OnTask</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Introduction/index.html">What is OnTask</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation process</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-the-required-tools">Installing the required tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#install-and-configure-redis">Install and Configure Redis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#install-and-configure-postgresql">Install and Configure PostgreSQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#install-python">Install Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="#download-install-and-configure-ontask">Download, install and configure OnTask</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-administration-pages">The Administration Pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#production-deployment">Production Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#authentication">Authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ldap-authentication">LDAP Authentication</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#email-configuration">Email Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scheduling-tasks">Scheduling tasks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Using/index.html">Using the tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorial/index.html">OnTask Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Advanced/index.html">Advanced Features</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../Introduction/index.html" title="previous chapter">What is OnTask</a></li>
      <li>Next: <a href="../Using/index.html" title="next chapter">Using the tool</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;Content Licensed under Creative Commons BY 3.0.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/Install/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>